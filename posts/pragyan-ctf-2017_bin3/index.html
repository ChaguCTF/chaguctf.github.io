<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> Pragyan CTF 2017: Roller Coaster Ride (150pts) | ChaGu CTF</title>
<link rel=canonical href=https://chagu.org/posts/pragyan-ctf-2017_bin3/>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="Pragyan CTF 2017: Roller Coaster Ride (150pts)">
<meta property="og:description" content="Challenge Description : Bobby has been into Reverse Engineering and Binary Exploitation lately. One day, he went to an amusement park in his city. It was very famouse for its Roller Coaster Rides. But, Bobby, being 12 years old, was not allowed on those rides, as it was open for people who were 14 years or older. This made Bobby very angry. On reaching home, he hacked into the servers of the amusement park, got hold of the validation software for the Roller Coaster rides, and modified it, so that nobody is allowed to have a ride on those Roller Coasters.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://chagu.org/posts/pragyan-ctf-2017_bin3/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-03-05T11:22:32+02:00">
<meta property="article:modified_time" content="2017-03-05T11:22:32+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Pragyan CTF 2017: Roller Coaster Ride (150pts)">
<meta name=twitter:description content="Challenge Description : Bobby has been into Reverse Engineering and Binary Exploitation lately. One day, he went to an amusement park in his city. It was very famouse for its Roller Coaster Rides. But, Bobby, being 12 years old, was not allowed on those rides, as it was open for people who were 14 years or older. This made Bobby very angry. On reaching home, he hacked into the servers of the amusement park, got hold of the validation software for the Roller Coaster rides, and modified it, so that nobody is allowed to have a ride on those Roller Coasters.">
<link rel=stylesheet href=https://chagu.org/css/styles.877f0d187d777677210859d158f899b22bc9251cff14ab3f2aeaaf7e09c4b15a691db4d151e8f0be980792a40c8d658ffb0a5ed37ea53eccec5125ee4e6055b7.css integrity="sha512-h38NGH13dnchCFnRWPiZsivJJRz/FKs/KuqvfgnEsVppHbTRUejwvpgHkqQMjWWP+wpe036lPszsUSXuTmBVtw=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://chagu.org/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://chagu.org/posts/pragyan-ctf-2017_bin2/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=https://chagu.org/posts/pragyan-ctf-2017_steg4/ aria-label=Next>
<i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&text=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&is_video=false&description=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&name=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29&description=Challenge%20Description%20%3a%20Bobby%20has%20been%20into%20Reverse%20Engineering%20and%20Binary%20Exploitation%20lately.%20One%20day%2c%20he%20went%20to%20an%20amusement%20park%20in%20his%20city.%20It%20was%20very%20famouse%20for%20its%20Roller%20Coaster%20Rides.%20But%2c%20Bobby%2c%20being%2012%20years%20old%2c%20was%20not%20allowed%20on%20those%20rides%2c%20as%20it%20was%20open%20for%20people%20who%20were%2014%20years%20or%20older.%20This%20made%20Bobby%20very%20angry.%20On%20reaching%20home%2c%20he%20hacked%20into%20the%20servers%20of%20the%20amusement%20park%2c%20got%20hold%20of%20the%20validation%20software%20for%20the%20Roller%20Coaster%20rides%2c%20and%20modified%20it%2c%20so%20that%20nobody%20is%20allowed%20to%20have%20a%20ride%20on%20those%20Roller%20Coasters." aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&t=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li></li>
</ul>
</li>
<li><a href=#script>Script:</a></li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
Pragyan CTF 2017: Roller Coaster Ride (150pts)
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2017-03-05 11:22:32 +0200 +0200" itemprop=datePublished>2017-03-05</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
2 minute read
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/reverse-engineering rel=tag>Reverse Engineering</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<h5 id=challenge-description->Challenge Description :</h5>
<pre tabindex=0><code>Bobby has been into Reverse Engineering and Binary Exploitation lately.
One day, he went to an amusement park in his city. It was very famouse for its Roller Coaster Rides.
But, Bobby, being 12 years old, was not allowed on those rides, as it was open for people who were 14 years or older.
This made Bobby very angry. On reaching home, he hacked into the servers of the amusement park, got hold of the validation software for the Roller Coaster rides, and modified it, so that nobody is allowed to have a ride on those Roller Coasters.

The authorities were in trouble now, as they weren't able to allow access to the Roller Coaster rides, without a Go-Ahead from their validation software.
They have come to you, asking for your help to fix their issue. Can you help them with it ??

NOTE :- Please enclose the flag in the format pragyanctf{&lt;flag&gt;}.

</code></pre><ul>
<li>File : <a href=files/validation>validation</a></li>
</ul>
<h4 id=solution>Solution:</h4>
<p>Running <code>file</code> on the binary revealed that it�s an ELF64 binary. Using IDA pro I could see that the main function calls another function called <code>verify_name_age()</code></p>
<p><img src=images/main.png alt=main></p>
<p>When running the binary it asks for the name then age then outputs that we are not allowed to the roller coaster whatever the age was. Looking at the verification function I noticed that there is a call just before the verification to a function called <code>f1()</code></p>
<p><img src=images/verify.png alt=main></p>
<p>Looking at the <code>f1()</code> function it tells that it jumps to yet another function:</p>
<p><img src=images/f1.png alt=main></p>
<p>The next function was <code>f6()</code> this function did a bunch of XOR using to numbers. And after finishing that it calls another function that does the same.</p>
<p><img src=images/f6.png alt=main></p>
<p>Tracing these function and writing down the numbers I came up with this map:</p>
<pre tabindex=0><code>======f6=======
26^104
133^181
252^205
160^204
42^1
======f7=======
226^150
77^37
132^183
0^109
194^157
======f8=======
241^197
2^51
188^141
20^57
======f4=======
242^135
222^174
104^71
176^240
======f2=======
130^236
======f3=======
58^94
======f9=======
150^232
======nsa=======
137^189
238^153
======f5=======
86^22
92^37
</code></pre><p>Writing <a href=files/binary3_sol.py>a script</a> with the previous order revealed the flag. <code>r01l+th3m_411-up/@nd~4w@y</code></p>
<h2 id=script>Script:</h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fl<span style=color:#f92672>=</span>[<span style=color:#ae81ff>26</span><span style=color:#f92672>^</span><span style=color:#ae81ff>104</span>,<span style=color:#ae81ff>133</span><span style=color:#f92672>^</span><span style=color:#ae81ff>181</span>,<span style=color:#ae81ff>252</span><span style=color:#f92672>^</span><span style=color:#ae81ff>205</span>,<span style=color:#ae81ff>160</span><span style=color:#f92672>^</span><span style=color:#ae81ff>204</span>,<span style=color:#ae81ff>42</span><span style=color:#f92672>^</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>226</span><span style=color:#f92672>^</span><span style=color:#ae81ff>150</span>,<span style=color:#ae81ff>77</span><span style=color:#f92672>^</span><span style=color:#ae81ff>37</span>,<span style=color:#ae81ff>132</span><span style=color:#f92672>^</span><span style=color:#ae81ff>183</span>,<span style=color:#ae81ff>0</span><span style=color:#f92672>^</span><span style=color:#ae81ff>109</span>,<span style=color:#ae81ff>194</span><span style=color:#f92672>^</span><span style=color:#ae81ff>157</span>,<span style=color:#ae81ff>241</span><span style=color:#f92672>^</span><span style=color:#ae81ff>197</span>,<span style=color:#ae81ff>2</span><span style=color:#f92672>^</span><span style=color:#ae81ff>51</span>,<span style=color:#ae81ff>188</span><span style=color:#f92672>^</span><span style=color:#ae81ff>141</span>,<span style=color:#ae81ff>20</span><span style=color:#f92672>^</span><span style=color:#ae81ff>57</span>,<span style=color:#ae81ff>242</span><span style=color:#f92672>^</span><span style=color:#ae81ff>135</span>,<span style=color:#ae81ff>222</span><span style=color:#f92672>^</span><span style=color:#ae81ff>174</span>,<span style=color:#ae81ff>104</span><span style=color:#f92672>^</span><span style=color:#ae81ff>71</span>,<span style=color:#ae81ff>176</span><span style=color:#f92672>^</span><span style=color:#ae81ff>240</span>,<span style=color:#ae81ff>130</span><span style=color:#f92672>^</span><span style=color:#ae81ff>236</span>,<span style=color:#ae81ff>58</span><span style=color:#f92672>^</span><span style=color:#ae81ff>94</span>,<span style=color:#ae81ff>150</span><span style=color:#f92672>^</span><span style=color:#ae81ff>232</span>,<span style=color:#ae81ff>137</span><span style=color:#f92672>^</span><span style=color:#ae81ff>189</span>,<span style=color:#ae81ff>238</span><span style=color:#f92672>^</span><span style=color:#ae81ff>153</span>,<span style=color:#ae81ff>86</span><span style=color:#f92672>^</span><span style=color:#ae81ff>22</span>,<span style=color:#ae81ff>92</span><span style=color:#f92672>^</span><span style=color:#ae81ff>37</span>]
flag<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> fl:
    flag<span style=color:#f92672>+=</span>chr(i)
print flag

</code></pre></div>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li></li>
</ul>
</li>
<li><a href=#script>Script:</a></li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&text=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&is_video=false&description=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&title=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&name=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29&description=Challenge%20Description%20%3a%20Bobby%20has%20been%20into%20Reverse%20Engineering%20and%20Binary%20Exploitation%20lately.%20One%20day%2c%20he%20went%20to%20an%20amusement%20park%20in%20his%20city.%20It%20was%20very%20famouse%20for%20its%20Roller%20Coaster%20Rides.%20But%2c%20Bobby%2c%20being%2012%20years%20old%2c%20was%20not%20allowed%20on%20those%20rides%2c%20as%20it%20was%20open%20for%20people%20who%20were%2014%20years%20or%20older.%20This%20made%20Bobby%20very%20angry.%20On%20reaching%20home%2c%20he%20hacked%20into%20the%20servers%20of%20the%20amusement%20park%2c%20got%20hold%20of%20the%20validation%20software%20for%20the%20Roller%20Coaster%20rides%2c%20and%20modified%20it%2c%20so%20that%20nobody%20is%20allowed%20to%20have%20a%20ride%20on%20those%20Roller%20Coasters." aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2fpragyan-ctf-2017_bin3%2f&t=Pragyan%20CTF%202017%3a%20Roller%20Coaster%20Ride%20%28150pts%29" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 ChaGu CTF
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>