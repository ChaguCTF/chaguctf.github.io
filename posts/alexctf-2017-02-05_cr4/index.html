<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> AlexCTF CR4:Poor RSA [200] | ChaGu CTF</title>
<link rel=canonical href=https://chagu.org/posts/alexctf-2017-02-05_cr4/>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="AlexCTF CR4:Poor RSA [200]">
<meta property="og:description" content="In this challenge we have a RSA public and a cipher text that we need to decypt. Since we know that RSA is broken only if we can factorize the modulus then thats is apperantly the goal.
To extract the modulus we use openssl to extract that information:
openssl rsa -noout -text -inform PEM -in key.pub -pubin Public-Key: (399 bit) Modulus: 52:a9:9e:24:9e:e7:cf:3c:0c:bf:96:3a:00:96:61: 77:2b:c9:cd:f6:e1:e3:fb:fc:6e:44:a0:7a:5e:0f: 89:44:57:a9:f8:1c:3a:e1:32:ac:56:83:d3:5b:28: ba:5c:32:42:43 Exponent: 65537 (0x10001) 52a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243 To get the integer representation we run the following:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://chagu.org/posts/alexctf-2017-02-05_cr4/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-02-05T11:22:32+02:00">
<meta property="article:modified_time" content="2017-02-05T11:22:32+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="AlexCTF CR4:Poor RSA [200]">
<meta name=twitter:description content="In this challenge we have a RSA public and a cipher text that we need to decypt. Since we know that RSA is broken only if we can factorize the modulus then thats is apperantly the goal.
To extract the modulus we use openssl to extract that information:
openssl rsa -noout -text -inform PEM -in key.pub -pubin Public-Key: (399 bit) Modulus: 52:a9:9e:24:9e:e7:cf:3c:0c:bf:96:3a:00:96:61: 77:2b:c9:cd:f6:e1:e3:fb:fc:6e:44:a0:7a:5e:0f: 89:44:57:a9:f8:1c:3a:e1:32:ac:56:83:d3:5b:28: ba:5c:32:42:43 Exponent: 65537 (0x10001) 52a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243 To get the integer representation we run the following:">
<link rel=stylesheet href=https://chagu.org/css/styles.877f0d187d777677210859d158f899b22bc9251cff14ab3f2aeaaf7e09c4b15a691db4d151e8f0be980792a40c8d658ffb0a5ed37ea53eccec5125ee4e6055b7.css integrity="sha512-h38NGH13dnchCFnRWPiZsivJJRz/FKs/KuqvfgnEsVppHbTRUejwvpgHkqQMjWWP+wpe036lPszsUSXuTmBVtw=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://chagu.org/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://chagu.org/posts/alexctf-2017-02-05_cr5/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=https://chagu.org/posts/alexctf-2017-02-05_cr3/ aria-label=Next>
<i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&text=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&is_video=false&description=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&name=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d&description=In%20this%20challenge%20we%20have%20a%20RSA%20public%20and%20a%20cipher%20text%20that%20we%20need%20to%20decypt.%20Since%20we%20know%20that%20RSA%20is%20broken%20only%20if%20we%20can%20factorize%20the%20modulus%20then%20thats%20is%20apperantly%20the%20goal.%0aTo%20extract%20the%20modulus%20we%20use%20openssl%20to%20extract%20that%20information%3a%0aopenssl%20rsa%20-noout%20-text%20-inform%20PEM%20-in%20key.pub%20-pubin%20Public-Key%3a%20%28399%20bit%29%20Modulus%3a%2052%3aa9%3a9e%3a24%3a9e%3ae7%3acf%3a3c%3a0c%3abf%3a96%3a3a%3a00%3a96%3a61%3a%2077%3a2b%3ac9%3acd%3af6%3ae1%3ae3%3afb%3afc%3a6e%3a44%3aa0%3a7a%3a5e%3a0f%3a%2089%3a44%3a57%3aa9%3af8%3a1c%3a3a%3ae1%3a32%3aac%3a56%3a83%3ad3%3a5b%3a28%3a%20ba%3a5c%3a32%3a42%3a43%20Exponent%3a%2065537%20%280x10001%29%2052a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243%20To%20get%20the%20integer%20representation%20we%20run%20the%20following%3a" aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&t=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents></nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
AlexCTF CR4:Poor RSA [200]
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2017-02-05 11:22:32 +0200 +0200" itemprop=datePublished>2017-02-05</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
1 minute read
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/rsa rel=tag>RSA</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<p>In this challenge we have a RSA public and a cipher text that we need to decypt.
Since we know that RSA is broken only if we can factorize the modulus then thats is apperantly the goal.</p>
<p>To extract the modulus we use openssl to extract that information:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl rsa -noout -text -inform PEM -in key.pub -pubin
Public-Key: <span style=color:#f92672>(</span><span style=color:#ae81ff>399</span> bit<span style=color:#f92672>)</span>
Modulus:
    52:a9:9e:24:9e:e7:cf:3c:0c:bf:96:3a:00:96:61:
    77:2b:c9:cd:f6:e1:e3:fb:fc:6e:44:a0:7a:5e:0f:
    89:44:57:a9:f8:1c:3a:e1:32:ac:56:83:d3:5b:28:
    ba:5c:32:42:43
Exponent: <span style=color:#ae81ff>65537</span> <span style=color:#f92672>(</span>0x10001<span style=color:#f92672>)</span>
52a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243
</code></pre></div><p>To get the integer representation we run the following:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>python <span style=color:#f92672>-</span>c <span style=color:#e6db74>&#34;print int(&#39;52a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243&#39;,16)&#34;</span>

<span style=color:#ae81ff>833810193564967701912362955539789451139872863794534923259743419423089229206473091408403560311191545764221310666338878019</span>
</code></pre></div><p>Now we do the factorization using the online service by factordb.com:</p>
<p><a href="http://www.factordb.com/index.php?query=833810193564967701912362955539789451139872863794534923259743419423089229206473091408403560311191545764221310666338878019">http://www.factordb.com/index.php?query=833810193564967701912362955539789451139872863794534923259743419423089229206473091408403560311191545764221310666338878019</a></p>
<p>we get the factors p and q:</p>
<p>p=863653476616376575308866344984576466644942572246900013156919
q=965445304326998194798282228842484732438457170595999523426901</p>
<p>We generate our private key using rsatool</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>python rsatool.py -f DER -o priv.key -p &lt;PVAL&gt; -q &lt;QVAL&gt;
</code></pre></div><p>We decode the base64 flag to assci:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cat flag.b64 | base64 -d &gt;flag.assci
</code></pre></div><p>And decrypt it using openssl:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>openssl rsautl -decrypt -inkey priv.key &lt; flag.assci &gt; decrypted
cat decrypted 
ALEXCTF<span style=color:#f92672>{</span>SMALL_PRIMES_ARE_BAD<span style=color:#f92672>}</span>
</code></pre></div>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents></nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&text=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&is_video=false&description=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d&body=Check out this article: https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&title=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&name=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d&description=In%20this%20challenge%20we%20have%20a%20RSA%20public%20and%20a%20cipher%20text%20that%20we%20need%20to%20decypt.%20Since%20we%20know%20that%20RSA%20is%20broken%20only%20if%20we%20can%20factorize%20the%20modulus%20then%20thats%20is%20apperantly%20the%20goal.%0aTo%20extract%20the%20modulus%20we%20use%20openssl%20to%20extract%20that%20information%3a%0aopenssl%20rsa%20-noout%20-text%20-inform%20PEM%20-in%20key.pub%20-pubin%20Public-Key%3a%20%28399%20bit%29%20Modulus%3a%2052%3aa9%3a9e%3a24%3a9e%3ae7%3acf%3a3c%3a0c%3abf%3a96%3a3a%3a00%3a96%3a61%3a%2077%3a2b%3ac9%3acd%3af6%3ae1%3ae3%3afb%3afc%3a6e%3a44%3aa0%3a7a%3a5e%3a0f%3a%2089%3a44%3a57%3aa9%3af8%3a1c%3a3a%3ae1%3a32%3aac%3a56%3a83%3ad3%3a5b%3a28%3a%20ba%3a5c%3a32%3a42%3a43%20Exponent%3a%2065537%20%280x10001%29%2052a99e249ee7cf3c0cbf963a009661772bc9cdf6e1e3fbfc6e44a07a5e0f894457a9f81c3ae132ac5683d35b28ba5c324243%20To%20get%20the%20integer%20representation%20we%20run%20the%20following%3a" aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fchagu.org%2fposts%2falexctf-2017-02-05_cr4%2f&t=AlexCTF%20CR4%3aPoor%20RSA%20%5b200%5d" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 ChaGu CTF
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writeups</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>